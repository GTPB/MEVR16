<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book  -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Practice | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../recombination/exercise1.html" />
    
    
    <link rel="prev" href="../recombination/theory.html" />
    

        <!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-quizzes/quizzes.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
    

        
    <div class="book" data-level="5.2" data-basepath=".." data-revision="Wed May 27 2015 09:49:07 GMT+0100 (BST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="intro/index.html">
            
                
                    <a href="../intro/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Background
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="intro/practice.html">
            
                
                    <a href="../intro/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Practice
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="intro/prerequisites.html">
            
                
                    <a href="../intro/prerequisites.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Prerequisites
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="intro/resources.html">
            
                
                    <a href="../intro/resources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Resources
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="getseq/index.html">
            
                
                    <a href="../getseq/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Retrieving sequences
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="getseq/theory.html">
            
                
                    <a href="../getseq/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="getseq/practice.html">
            
                
                    <a href="../getseq/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="getseq/example1.html">
            
                
                    <a href="../getseq/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                        Retrieving sequences example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="getseq/example2.html">
            
                
                    <a href="../getseq/example2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.2.</b>
                        
                        Retrieving annotations example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="getseq/exercises.html">
            
                
                    <a href="../getseq/exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.3.</b>
                        
                        Exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="align/index.html">
            
                
                    <a href="../align/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Sequence alignment
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="align/theory.html">
            
                
                    <a href="../align/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="align/practice.html">
            
                
                    <a href="../align/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="align/example1.html">
            
                
                    <a href="../align/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.1.</b>
                        
                        Nucleotide alignment
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="align/example2.html">
            
                
                    <a href="../align/example2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.2.</b>
                        
                        Reverse alignment
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="align/exercise1.html">
            
                
                    <a href="../align/exercise1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.3.</b>
                        
                        Exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="distance/index.html">
            
                
                    <a href="../distance/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Distance-based analyses
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="distance/theory.html">
            
                
                    <a href="../distance/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="distance/practice.html">
            
                
                    <a href="../distance/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="distance/example1.html">
            
                
                    <a href="../distance/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.1.</b>
                        
                        Neighbour joining example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="distance/exercise1.html">
            
                
                    <a href="../distance/exercise1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.</b>
                        
                        Exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="recombination/index.html">
            
                
                    <a href="../recombination/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Recombination
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="recombination/theory.html">
            
                
                    <a href="../recombination/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="5.2" data-path="recombination/practice.html">
            
                
                    <a href="../recombination/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="recombination/exercise1.html">
            
                
                    <a href="../recombination/exercise1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.1.</b>
                        
                        Exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="ml/index.html">
            
                
                    <a href="../ml/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Maximum likelihood based analyses
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="ml/theory.html">
            
                
                    <a href="../ml/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="ml/practice.html">
            
                
                    <a href="../ml/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.2.1" data-path="ml/example1.html">
            
                
                    <a href="../ml/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.1.</b>
                        
                        Model choice example
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="ml/raxml.html">
            
                
                    <a href="../ml/raxml.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        RAxML example
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.3.1" data-path="ml/exercise1.html">
            
            <span><b>6.3.1.</b> Tree reconstruction exercise</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="viz/index.html">
            
                
                    <a href="../viz/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Visualising trees
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="viz/theory.html">
            
                
                    <a href="../viz/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="viz/practice.html">
            
                
                    <a href="../viz/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" >
            
            <span><b>7.2.1.</b> [```ggtree``` exercise)(viz/exercise2.md)</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="timetree/index.html">
            
                
                    <a href="../timetree/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Time-stamped phylogenies
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="timetree/theory.html">
            
                
                    <a href="../timetree/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="timetree/practice.html">
            
                
                    <a href="../timetree/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="timetree/rtt_exercise.html">
            
                
                    <a href="../timetree/rtt_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.</b>
                        
                        Root-to-tip exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.2.2" data-path="timetree/lsd_exercise.html">
            
                
                    <a href="../timetree/lsd_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.</b>
                        
                        Least squares dating exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.2.3" data-path="timetree/mb_exercise.html">
            
            <span><b>8.2.3.</b> MrBayes exercise</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="ne/index.html">
            
                
                    <a href="../ne/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Effective population size estimation
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="ne/theory.html">
            
                
                    <a href="../ne/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="ne/practice.html">
            
                
                    <a href="../ne/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="ne/coalescent_exercise.html">
            
                
                    <a href="../ne/coalescent_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.1.</b>
                        
                        Fitting coalescent models
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9.2.2" data-path="ne/bd_exercise.html">
            
                
                    <a href="../ne/bd_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.2.</b>
                        
                        Fitting birth-death models
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="treeshape/index.html">
            
                
                    <a href="../treeshape/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Tree shape
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="treeshape/theory.html">
            
                
                    <a href="../treeshape/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="treeshape/practice.html">
            
                
                    <a href="../treeshape/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.2.1" data-path="treeshape/asymm_exercise.html">
            
                
                    <a href="../treeshape/asymm_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.1.</b>
                        
                        Asymmetry exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="11" data-path="structure/index.html">
            
                
                    <a href="../structure/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Structured populations
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="11.1" data-path="structured/theory.html">
            
                
                    <a href="../structured/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11.2" data-path="structured/practice.html">
            
                
                    <a href="../structured/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="11.2.1" data-path="structure/mugration_exercise.html">
            
                
                    <a href="../structure/mugration_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.2.1.</b>
                        
                        &#39;Mugration&#39; exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11.2.2" data-path="structure/colgem_exercise.html">
            
                
                    <a href="../structure/colgem_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.2.2.</b>
                        
                        ```colgem``` exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="12" data-path="workflow/index.html">
            
                
                    <a href="../workflow/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Workflows
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="12.1" data-path="workflow/example1.html">
            
                
                    <a href="../workflow/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.1.</b>
                        
                        An example analysis
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="13" data-path="discuss/index.html">
            
                
                    <a href="../discuss/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Discussion
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="references.html">
            
                
                    <a href="../references.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        References
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <a href="../GLOSSARY.html" class="btn pull-left" aria-label="Glossary"><i class="fa fa-sort-alpha-asc"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" ></a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="practice">Practice</h1>
<h2 id="prerequisites">Prerequisites</h2>
<h3 id="load-libraries">Load libraries</h3>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(ape)
<span class="hljs-keyword">library</span>(stepwise)
<span class="hljs-keyword">library</span>(magrittr)
<span class="hljs-keyword">library</span>(kdetrees)
<span class="hljs-keyword">library</span>(phangorn)
<span class="hljs-keyword">source</span>(<span class="hljs-string">&quot;recombination.R&quot;</span>)
</code></pre>
<p>In addition to the libraries, I have also written some functions:</p>
<ul>
<li><code>slidingWindowAlignment</code>: generates sliding window alignments</li>
<li><code>sbtest</code>: generates trees either side of a breakpoint, and calculates the distance between the trees</li>
<li><code>disttree</code>: calculates distances between all trees in a list</li>
</ul>
<h3 id="set-filename-and-outgroup">Set filename and outgroup</h3>
<pre><code class="lang-r">seqfilename &lt;- <span class="hljs-string">&quot;CRF7.fas&quot;</span>
outgroup &lt;- <span class="hljs-string">&quot;J_SE7887&quot;</span>
</code></pre>
<h3 id="read-fasta-file">Read <a href="../GLOSSARY.html#fasta" class="glossary-term" title="A widely used sequence format, which has a sequence label beginning with &apos;&gt;&apos;, followed by the sequence.">FASTA</a> file</h3>
<pre><code class="lang-r">seqdata &lt;- read.dna(seqfilename,format=<span class="hljs-string">&quot;<a href="../GLOSSARY.html#fasta" class="glossary-term" title="A widely used sequence format, which has a sequence label beginning with &apos;&gt;&apos;, followed by the sequence.">fasta</a>&quot;</span>,as.matrix=<span class="hljs-literal">TRUE</span>)
seqdata
</code></pre>
<pre><code>## 10 DNA sequences in binary format stored in a matrix.
## 
## All sequences of same length: 7894 
## 
## Labels: C_C2220 CRF7_C54A A_92UG037 B_JRFL D_NDK F_93BR020 ...
## 
## Base composition:
##     a     c     g     t 
## 0.366 0.173 0.236 0.225
</code></pre><h3 id="output-data-with-clean-sequence-names-in-phylip-format">Output data with &apos;clean&apos; sequence names in Phylip format</h3>
<p>Some of the tests we will use need to have sequence data in Phylip format, so we use R to convert.</p>
<pre><code class="lang-r">seqdata.stepwise &lt;- seqdata
row.names(seqdata.stepwise) &lt;- makeLabel(row.names(seqdata),len=<span class="hljs-number">9</span>)
write.dna(seqdata.stepwise,file=paste(seqfilename,<span class="hljs-string">&quot;.stepwise&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>),format=<span class="hljs-string">&quot;interleaved&quot;</span>,colsep=<span class="hljs-string">&quot;&quot;</span>,nbcol=-<span class="hljs-number">1</span>)
</code></pre>
<h2 id="test-for-recombination-using-maxchi">Test for recombination using Maxchi</h2>
<pre><code class="lang-r">seqdata.maxchi &lt;- maxchi(paste(seqfilename,<span class="hljs-string">&quot;.stepwise&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>),breaks=seg.sites(seqdata),winHalfWidth=<span class="hljs-number">50</span>,permReps=<span class="hljs-number">100</span>)
summary(seqdata.maxchi)
</code></pre>
<pre><code>## --------------------------------------------------
## There were 12 site-specific MaxChi statistics significant at the
## 10 percent level (90th percentile = 21.007, 95th percentile = 22.243):
## 
## Number Location  MaxChi   pairs
##      1      293  23.645*   (B_JRFL    :G_92NG083 )
##      2      294  21.583*   (B_JRFL    :G_92NG083 )
##      3      297  23.377*   (B_JRFL    :G_92NG083 )
##      4      300  25.253*   (B_JRFL    :G_92NG083 )
##      5      301  23.377*   (B_JRFL    :G_92NG083 )
##      6      387  21.236*   (B_JRFL    :G_92NG083 )
##      7     6022  23.188*   (CRF7_C54A :G_92NG083 )
##      8     6084  21.374*   (C_C2220   :G_92NG083 )
##      9     6085  23.377*   (C_C2220   :G_92NG083 )
##     10     6090  21.374*   (CRF7_C54A :G_92NG083 )
##     11     6091  23.188*   (CRF7_C54A :G_92NG083 )
##     12     6092  21.374*   (C_C2220   :G_92NG083 )
## --------------------------------------------------
## Notes - &quot;Location&quot; is the polymorphic site just before the proposed breakpoint.
##       - MaxChi statistics significant at the 5 percent level indicated by a *
</code></pre><h2 id="test-for-recombination-using-phylogenetic-profiling">Test for recombination using phylogenetic profiling</h2>
<p>Running the same window and permutations using phylogenetic profiling.</p>
<pre><code class="lang-r">seqdata.phylpro &lt;- phylpro(paste(seqfilename,<span class="hljs-string">&quot;.stepwise&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>),breaks=seg.sites(seqdata),winHalfWidth=<span class="hljs-number">50</span>,permReps=<span class="hljs-number">100</span>)
summary(seqdata.phylpro)
</code></pre>
<pre><code>## Length  Class   Mode 
##      0   NULL   NULL
</code></pre><h2 id="test-for-recombination-using-a-sliding-window-phylogeny">Test for recombination using a sliding window <a href="../GLOSSARY.html#phylogeny" class="glossary-term" title="A phylogeny is a branching diagram or tree showing the inferred evolutionary relationships among various biological species, based on differences in their physical or genetic characteristics &lt;a href=&quot;http://en.wikipedia.org/wiki/Phylogenetic_tree&quot;&gt;Wikipedia entry&lt;/a&gt;.">phylogeny</a></h2>
<p>We have already covered making a tree with a sequence alignment using a distance based approach, which involves making a distance matrix, performing tree reconstruction, perhaps rooting the tree, and plotting it out.</p>
<h3 id="making-a-set-of-trees">Making a set of trees</h3>
<p>As the sequences are stored in a matrix, it is straightforward to make a list of alignments, each of which is a window on the original alignment.</p>
<p>The following command generates sequence alignments 300 base pairs long, moving in steps of 10.</p>
<pre><code class="lang-r">seqdata.slide &lt;- slidingWindowAlignment(seqdata,<span class="hljs-number">300</span>,<span class="hljs-number">10</span>)
length(seqdata.slide)
</code></pre>
<pre><code>## [1] 760
</code></pre><p>This generates a list of alignments. In R, there is a command, <code>lapply</code>, that applies a command to each element in a list. The following generates a list of distance matrices, then a list of neighbour joining trees.</p>
<pre><code class="lang-r">seqdata.slide.nj &lt;- lapply(seqdata.slide,dist.dna,model=<span class="hljs-string">&quot;<a href="../GLOSSARY.html#tn93" class="glossary-term" title="The Tamura-Nei model of nucleotide substitution. See &lt;a href=&quot;http://en.wikipedia.org/wiki/Models_of_DNA_evolution&quot;&gt;this Wikipedia entry&lt;/a&gt; for details of this and other models of DNA evolution.">TN93</a>&quot;</span>,as.matrix=<span class="hljs-literal">TRUE</span>) %&gt;%
  lapply(.,njs)
</code></pre>
<h3 id="outlier-detection">Outlier detection</h3>
<p>We now have a list of trees. How do we determine whether a single tree explains all the sub-alignments? One approach is to work out whether there are &apos;outlying trees&apos;. The command <code>kdetrees</code> computes a distribution of trees, then determines whether there are trees in the &apos;tail&apos; of the distribution. This requires an outgroup sequence to root the tree.</p>
<pre><code class="lang-r">seqdata.slide.nj.kde &lt;- kdetrees(seqdata.slide.nj,outgroup=outgroup)
seqdata.slide.nj.kde
</code></pre>
<pre><code>## Call: kdetrees(trees = seqdata.slide.nj, outgroup = outgroup)
## Density estimates:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   915.4  2071.0  2364.0  2272.0  2531.0  2906.0 
## Cutoff:  1380.953 
## 
## Outliers detected:
##  [1] 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593
## [18] 594 595 596 597 598 599 600 601 602 603 604 605
</code></pre><p>Plotting out the output from this function will show the outlying trees, as a function of the index of the tree - each of which represents the tree from a slice of the original alignment.</p>
<pre><code class="lang-r">plot(seqdata.slide.nj.kde)
</code></pre>
<p><figure><img src="figure/unnamed-chunk-11-1.png" alt="plot of chunk unnamed-chunk-11"><figcaption>Figure: plot of chunk unnamed-chunk-11</figcaption></figure> </p>
<p>We can also plot out a histogram.</p>
<pre><code class="lang-r">hist(seqdata.slide.nj.kde)
</code></pre>
<p><figure><img src="figure/unnamed-chunk-12-1.png" alt="plot of chunk unnamed-chunk-12"><figcaption>Figure: plot of chunk unnamed-chunk-12</figcaption></figure> </p>
<p>Lets take two trees, one outlier, and one non-outlier.</p>
<pre><code class="lang-r">par(mfrow=c(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))
plot(seqdata.slide.nj[[<span class="hljs-number">200</span>]])
plot(seqdata.slide.nj[[<span class="hljs-number">600</span>]])
</code></pre>
<p><figure><img src="figure/unnamed-chunk-13-1.png" alt="plot of chunk unnamed-chunk-13"><figcaption>Figure: plot of chunk unnamed-chunk-13</figcaption></figure> </p>
<p>How are these different?</p>
<p>The command <code>cophyloplot</code> in <code>ape</code> allows us to plot two trees face-to-face in order to compare them more easily. This function takes the two trees as arguments, plus a matrix with the associations between the labels in the two trees - this is for cases where the labels in the trees may be different (e.g. comparing host and parasite phylogenies). In our case, the labels are the same.</p>
<pre><code class="lang-r">association &lt;- matrix(c(<span class="hljs-string">&quot;CRF7_C54A&quot;</span>,<span class="hljs-string">&quot;CRF7_C54A&quot;</span>),nrow=<span class="hljs-number">1</span>,ncol=<span class="hljs-number">2</span>)
cophyloplot(seqdata.slide.nj[[<span class="hljs-number">200</span>]],seqdata.slide.nj[[<span class="hljs-number">600</span>]],assoc=association)
</code></pre>
<p><figure><img src="figure/unnamed-chunk-14-1.png" alt="plot of chunk unnamed-chunk-14"><figcaption>Figure: plot of chunk unnamed-chunk-14</figcaption></figure> </p>
<h2 id="single-breakpoint-test">Single breakpoint test</h2>
<p>A sliding window approach may be best if there are recombinant fragments, but if the sequences have a single recombinant breakpoint, then a different approach may be more powerful. This function splits the alignment into two (at least 300 base pairs long), and calculates the distance between the trees for either side of the breakpoint.</p>
<pre><code class="lang-r">seqdata.sbt &lt;- sbtest(seqdata,<span class="hljs-number">300</span>,<span class="hljs-string">&quot;<a href="../GLOSSARY.html#tn93" class="glossary-term" title="The Tamura-Nei model of nucleotide substitution. See &lt;a href=&quot;http://en.wikipedia.org/wiki/Models_of_DNA_evolution&quot;&gt;this Wikipedia entry&lt;/a&gt; for details of this and other models of DNA evolution.">TN93</a>&quot;</span>)
</code></pre>
<p>Now we can plot the distance between the trees as a function of the breakpoint.</p>
<pre><code class="lang-r">plot(symdiff~breakpoint,data=seqdata.sbt,type=<span class="hljs-string">&quot;s&quot;</span>)
</code></pre>
<p><figure><img src="figure/unnamed-chunk-16-1.png" alt="plot of chunk unnamed-chunk-16"><figcaption>Figure: plot of chunk unnamed-chunk-16</figcaption></figure> </p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../recombination/theory.html" class="navigation navigation-prev " aria-label="Previous page: Theory"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../recombination/exercise1.html" class="navigation navigation-next " aria-label="Next page: Exercise"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-quizzes/quizzes.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-codeblock-disable-glossary/disable-glossary.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"autocover":{"title":"Molecular Epidemiology of Viruses in R","author":"Simon D.W. Frost","font":{"size":null,"family":"Impact","color":"#FFF"},"size":{"w":1800,"h":2360},"background":{"color":"#09F"}}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
    </body>
    <!-- End of book  -->
</html>
