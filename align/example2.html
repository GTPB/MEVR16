<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book  -->
    <head>
        <!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Reverse alignment | </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../align/exercise1.html" />
    
    
    <link rel="prev" href="../align/example1.html" />
    

        <!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-quizzes/quizzes.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
    

        
    <div class="book" data-level="3.2.2" data-basepath=".." data-revision="Mon May 25 2015 09:08:34 GMT+0100 (BST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="intro/index.html">
            
                
                    <a href="../intro/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Background
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="intro/practice.html">
            
                
                    <a href="../intro/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Practice
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="intro/prerequisites.html">
            
                
                    <a href="../intro/prerequisites.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Prerequisites
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="intro/resources.html">
            
                
                    <a href="../intro/resources.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Resources
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="getseq/index.html">
            
                
                    <a href="../getseq/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Retrieving sequences
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="getseq/theory.html">
            
                
                    <a href="../getseq/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="getseq/practice.html">
            
                
                    <a href="../getseq/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="getseq/example1.html">
            
                
                    <a href="../getseq/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                        Retrieving sequences example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="getseq/example2.html">
            
                
                    <a href="../getseq/example2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.2.</b>
                        
                        Retrieving annotations example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="getseq/exercises.html">
            
                
                    <a href="../getseq/exercises.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.3.</b>
                        
                        Exercises
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="align/index.html">
            
                
                    <a href="../align/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Sequence alignment
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="align/theory.html">
            
                
                    <a href="../align/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="align/practice.html">
            
                
                    <a href="../align/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="align/example1.html">
            
                
                    <a href="../align/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.1.</b>
                        
                        Nucleotide alignment
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="3.2.2" data-path="align/example2.html">
            
                
                    <a href="../align/example2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.2.</b>
                        
                        Reverse alignment
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="align/exercise1.html">
            
                
                    <a href="../align/exercise1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.3.</b>
                        
                        Exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="distance/index.html">
            
                
                    <a href="../distance/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Distance-based analyses
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="distance/theory.html">
            
                
                    <a href="../distance/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="distance/practice.html">
            
                
                    <a href="../distance/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="distance/example1.html">
            
                
                    <a href="../distance/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.1.</b>
                        
                        Neighbour joining example
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="distance/exercise1.html">
            
                
                    <a href="../distance/exercise1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.</b>
                        
                        Exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="ml/index.html">
            
                
                    <a href="../ml/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Maximum likelihood based analyses
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="ml/theory.html">
            
                
                    <a href="../ml/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="ml/practice.html">
            
                
                    <a href="../ml/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="ml/exercise1.html">
            
                
                    <a href="../ml/exercise1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.1.</b>
                        
                        Model choice exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="ml/raxml.html">
            
                
                    <a href="../ml/raxml.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.2.</b>
                        
                        RAxML exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="viz/index.html">
            
                
                    <a href="../viz/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Visualising trees
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="viz/theory.html">
            
                
                    <a href="../viz/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="viz/practice.html">
            
                
                    <a href="../viz/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.2.1" >
            
            <span><b>6.2.1.</b> [```ggtree``` exercise)(viz/exercise2.md)</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="timetree/index.html">
            
                
                    <a href="../timetree/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Time-stamped phylogenies
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1" data-path="timetree/theory.html">
            
                
                    <a href="../timetree/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="timetree/practice.html">
            
                
                    <a href="../timetree/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="timetree/rtt_exercise.html">
            
                
                    <a href="../timetree/rtt_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.1.</b>
                        
                        Root-to-tip exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="timetree/lsd_exercise.html">
            
                
                    <a href="../timetree/lsd_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.2.2.</b>
                        
                        Least squares dating exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7.2.3" data-path="timetree/mb_exercise.html">
            
            <span><b>7.2.3.</b> MrBayes exercise</span>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8" data-path="ne/index.html">
            
                
                    <a href="../ne/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Effective population size estimation
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="ne/theory.html">
            
                
                    <a href="../ne/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="ne/practice.html">
            
                
                    <a href="../ne/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="ne/coalescent_exercise.html">
            
                
                    <a href="../ne/coalescent_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.1.</b>
                        
                        Fitting coalescent models
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8.2.2" data-path="ne/bd_exercise.html">
            
                
                    <a href="../ne/bd_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.2.</b>
                        
                        Fitting birth-death models
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="treeshape/index.html">
            
                
                    <a href="../treeshape/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Tree shape
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="treeshape/theory.html">
            
                
                    <a href="../treeshape/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="treeshape/practice.html">
            
                
                    <a href="../treeshape/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="treeshape/asymm_exercise.html">
            
                
                    <a href="../treeshape/asymm_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.1.</b>
                        
                        Asymmetry exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="structure/index.html">
            
                
                    <a href="../structure/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Structured populations
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1" data-path="structured/theory.html">
            
                
                    <a href="../structured/theory.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.1.</b>
                        
                        Theory
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="structured/practice.html">
            
                
                    <a href="../structured/practice.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.</b>
                        
                        Practice
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.2.1" data-path="structure/mugration_exercise.html">
            
                
                    <a href="../structure/mugration_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.1.</b>
                        
                        &#39;Mugration&#39; exercise
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10.2.2" data-path="structure/colgem_exercise.html">
            
                
                    <a href="../structure/colgem_exercise.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.2.2.</b>
                        
                        ```colgem``` exercise
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="11" data-path="workflow/index.html">
            
                
                    <a href="../workflow/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Workflows
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="11.1" data-path="workflow/example1.html">
            
                
                    <a href="../workflow/example1.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.1.</b>
                        
                        An example analysis
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="12" data-path="discuss/index.html">
            
                
                    <a href="../discuss/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Discussion
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="references.html">
            
                
                    <a href="../references.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        References
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <a href="../GLOSSARY.html" class="btn pull-left" aria-label="Glossary"><i class="fa fa-sort-alpha-asc"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" ></a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h2 id="align-in-protein-space">Align in protein space</h2>
<p>Alignment in protein space is potentially more accurate (although not always), but to do so reliably is not straightforward. This makes this section more appropriate for advanced users, who want to automate alignment of potentially difficult sequence datasets.</p>
<h3 id="loading-libraries">Loading libraries</h3>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(Biostrings)
<span class="hljs-keyword">library</span>(seqinr)
<span class="hljs-keyword">source</span>(<span class="hljs-string">&quot;utils.R&quot;</span>)
</code></pre>
<h2 id="getting-a-good-translation">Getting a good translation</h2>
<p>First, we have to translate the sequences into amino acids. We can&apos;t assume that the sequences are in frame 1, so we have to find the correct frame for each.</p>
<h3 id="identifying-the-right-frame-by-counting-stops">Identifying the right frame by counting stops</h3>
<p>The simplest way is to count the number of stop codons in each reading frame.</p>
<pre><code class="lang-r">nucseq.fn &lt;- <span class="hljs-string">&quot;ray2000_edited.fas&quot;</span>
nucseq &lt;- read.fasta(nucseq.fn)
</code></pre>
<p>In <code>utils.R</code>, there is a function that counts the number of stop codons in each frame.</p>
<pre><code class="lang-r">numstops &lt;- lapply(nucseq,countstops)
</code></pre>
<p>However, when we look at the results, we can see that there is one sequence where there are two frames with no stop codons.</p>
<pre><code class="lang-r">lapply(numstops,paste,collapse=<span class="hljs-string">&quot; &quot;</span>) %&gt;% unlist %&gt;% unname %&gt;% table %&gt;% as.data.frame.table
</code></pre>
<pre><code>##        . Freq
## 1  0 3 2    1
## 2  0 3 3    1
## 3  0 3 4    1
## 4  0 3 5    2
## 5  0 4 2    6
## 6  0 4 3   22
## 7  0 4 4    9
## 8  0 4 6    1
## 9  0 5 2    1
## 10 0 5 3    2
## 11 0 5 4    4
## 12 0 6 2    2
## 13 0 6 4    1
## 14 0 6 5    1
## 15 0 7 3    2
## 16 0 7 7    1
## 17 0 8 2    1
## 18 0 8 4    1
## 19 1 4 0    1
## 20 1 5 0    1
## 21 1 5 3    1
## 22 1 6 5    1
## 23 2 3 0    1
## 24 2 4 0    1
## 25 2 6 0    1
## 26 3 3 0    2
## 27 4 3 0    1
## 28 5 0 0    1
## 29 6 4 0    1
</code></pre><h3 id="finding-open-reading-frames">Finding open reading frames</h3>
<p>Another approach involves finding the longest open reading frame.</p>
<pre><code class="lang-r">nucseq.fn &lt;- <span class="hljs-string">&quot;ray2000_edited.fas&quot;</span>
nucseq.orf.fn &lt;- <span class="hljs-string">&quot;ray2000_edited.fas.orf&quot;</span>
</code></pre>
<p>Finding the longest open reading frame greater than a minimum size (say 400 bases) is possible in R, but I have yet to find a solution that is as fast as using an external program. We will use <code>getorf</code> from the EMBOSS software suite.</p>
<pre><code class="lang-r">cmd &lt;- sprintf(<span class="hljs-string">&quot;getorf -sequence %s -outseq %s -find 2 -minsize 405&quot;</span>,nucseq.fn,nucseq.orf.fn)
system(cmd)
</code></pre>
<p>Here we can see that we now have one less sequence than before.</p>
<pre><code class="lang-r">nucseq.orf &lt;- read.fasta(nucseq.orf.fn)
length(nucseq.orf)
</code></pre>
<pre><code>## [1] 70
</code></pre><h3 id="align-to-a-reference-sequence">Align to a reference sequence</h3>
<p>Another approach is to map to a reference sequence that is in frame. We load in a reference sequence.</p>
<pre><code class="lang-r">subject &lt;- read.fasta(<span class="hljs-string">&quot;hcv4.fas&quot;</span>)[[<span class="hljs-number">1</span>]] %&gt;%
  as.character %&gt;%
  toupper %&gt;%
  c2s
subject
</code></pre>
<pre><code>## [1] &quot;TTCACGCAGAAAGCGTCTAGCCATGGCGTTAGTATGAGTGTTGTACAGCCTCCAGGACCCCCCCTCCCGGGAGAGCCATAGTGGTCTTCGGAACCGGTGAGTACACCGGAATCGCCGGGATGACCGGGTCCTTTCTTGGATTAACCCGCTCAATGCCCGGAAATTTGGGCGTGCCCCCGCAAGACTGCTAGCCGAGTAGTGTTGGGTCGCGAAAGGCCTTGCGGTACTGCCTGATAGGGTGCTTGCGAGTGCCCCGGGAGGTCTCGTAGACCGTGCACCATGAGCACGAATCCTAAACCTCAAAGAAAAACCAAACGTAACACCAACCGCCGCCCAATGGACGTTAAGTTCCCGGGTGGTGGCCAGATCGTTGGCGGAGTTTACTTGTTGCCGCGCAGGGGCCCCAGATTGGGTGTGCGCGCGACTCGGAAGACTTCGGAGCGGTCGCAACCTCGTGGAAGACGCCAACCTATCCCCAAGGCGCGTCGACCCGAGGGAAGGTCCTGGGCACAACCAGGATATCCATGGCCTCTTTACGGTAATGAGGGTTGTGGGTGGGCAGGATGGCTCTTGTCCCCCCGTGGCTCTCGACCGTCTTGGGGCCCAAATGATCCCCGCGGGAGGTCCCGCAATTTGGGTAAGGTCATCGATACCCTAACCTGCGGCTTCGCCGACCTCATGGGATACATCCCGCTCGTAGGCGCCCCCGTGGGTAGCGTCGCCAGGGCCCTGGCACATGGTGTCAGGGCTTTGGAGGACGGGATCAATTATGCAACAGGGAATCTCCCCGGTTGCTCCTTTTCTATCTTCCTCTTGGCACTTCTTTCGTGCCTGACTGTCCCCGCTTCGGCCGTTAACTATCGCAATGTCTCAGGCATCTACCATGTCACCAATGACTGCCCGAATTCAAGCATAGTGTATGAGGCCGACCATCACATCATGCACCTTCCAGGTTGCGTGCCCTGCGTGAGAGAGGGGAATCAGTCACGCTGCTGGGTGGCCCTTACTCCTACCGTCGCAGCGCCATACATCGGCGCACCGCTTGAGTCCTTACGGAGTCATGTGGATTTGATGGTGGGGGCCGCCACTGTCTGCTCGGGTCTTTACATCGGGGACCTGTGTGGCGGCTTGTTCCTAGTTGGCCAGATGTTTTCATTCCGACCACGGCGCCACTGGACCACCCAGGATTGCAATTGTTCCATCTACACAGGGCACATTACAGGCCACAGAATGGCCTGGGACATGATGATGAACTGGAGTCCAACAACCACCTTAGTTCTCGCCCAGGTCATGAGGATCCCAACCACTCTGGTAGACTTACTCTCTGGAGGCCACTGGGGTGTCCTCGTGGGGGTGGCCTATTTCAGCATGCAGGCCAATTGGGCCAAAGTCATCTTGGTCCTATTCCTCTTTGCAGGGGTTGATGCCGAGACTCACGTGTCTGGGGCAGCAGTCGGCCGGAGTACCGCCGGCTTGGCTAACCTCTTTTCTTCTGGGTCTAAGCAGAATTTACAGCTCATCAACAGCAATGGGAGCTGGCATATAAATAGGACTGCCCTTAACTGCAATGACAGCTTAAACACTGGGTTCTTGGCTAGCTTGTTCTACACCCACAAGTTTAACAGCTCAGGGTGTTCCGAACGGCTCGCGTGCTGCAAGAGCCTTGACAGCTACGGCCAAGGCTGGGGCCCACTCGGGGTCGCTAACATCAGCGGCTCGTCTGATGACAGGCCTTATTGCTGGCACTACGCGCCTCGGCCATGCGGGATTGTGCCAGCATCCAGTGTGTGTGGCCCCGTGTATTGTTTCACTCCCAGCCCTGTCGTGGTCGGTACTACTGATCACGTCGGGGTCCCTACTTACACCTGGGGGGAGAACGAGACTGATGTCTTCCTTTTGAACTCGACCAGACCGCCGCATGGTGCGTGGTTTGGATGCGTGTGGATGAACAGTACCGGGTTCACCAAAACCTGTGGCGCCCCTCCATGCGAGGTTAACACCAATAATGGGACCTGGCACTGCCCCACCGATTGCTTCAGGAAGCATCCGGAGACTACCTACGCCAAGTGCGGATCAGGGCCTTGGATCACACCACGCTGCCTGATTGATTACCCGTACCGGCTGTGGCATTTCCCGTGCACCGCCAACTTCTCCGTCTTTAACATCAGGACATTTGTCGGCGGTATAGAGCATCGGATGCAAGCGGCATGCAACTGGACCAGGGGGGAAGTCTGTGGCTTGGAGCACAGGGATCGGGTAGAGCTATCACCCCTGCTCCTTACCACTACAGCGTGGCAGATCCTCCCCTGCTCTTTCACCACTTTACCTGCCCTCTCCACCGGCTTGATCCACCTCCACCAAAATATCGTGGACGTCCAGTACCTCTATGGTGTTGGATCTGCAGTGGTATCTTGGGCCCTTAAGTGGGAATATGTGGTGCTCGCGTTCCTGCTTCTCGCGGACGCGAGAGTCTCTGCCTACCTATGGATGATGTTTATGGTAAGTCAAGTTGAGGCGGCTCTGTCCAACCTAATTAACATCAATGCTGCTTCAGCCGCTGGTGCCCAAGGCTTCTGGTACGCCATCCTCTTCATCTGCATTGTCTGGCATGTCAAGGGCCGGTTCCCAGCTGCTGCTGCCTACGCAGCCTGCGGGCTGTGGCCCTGTTTTCTCCTGCTTCTGATGCTGCCTGAGAGGGCTTATGCATACGACCAGGAAGTGGCAGGGTCCCTTGGCGGCGCCATCGTTGTCATGCTGACCATTCTGACACTGTCTCCGCACTACAAGTTATGGCTGGCTAGGGGATTGTGGTGGATCCAATATTTTATAGCTAGGACCGAGGCTGTGCTGCATGTCTATATTCCATCCTTCAACGTGCGCGGGCCTCGCGACTCAGTGATTGTTCTTGCAGTCCTGGTCTGTCCAGACCTAGTATTTGACATCACAAAATATCTTCTGGCCATCTTAGGGCCCCTCCACATACTCCAGGCCTCGCTCCTACGCATCCCTTACTTTGTGAGGGCACAAGCGCTGGTTAAGATCTGCAGCTTGTTGCGTGGGGTAGTTTATGGCAAGTACTTCCAAATGGTCGTGCTTAAAAGCAGGGGCCTGACTGGTACTTACATCTATGACCACCTTACTCCCATGTCAGATTGGCCGCCTTACGGCCTCCGCGATTTGGCGGTGGCCCTAGAGCCAGTTGTGTTCACGCCCATGGAGAAGAAAGTCATCGTCTGGGGCGCTGACACCGCTGCGTGCGGAGACATCATAAGGGGATTACCTGTTTCGGCCAGGTTGGGCAATGAGATCTTGCTCGGACCAGCCGATACAGAAACATCAAAGGGGTGGAGACTCCTTGCCCCCATCACAGCATACGCNCAGCAGACCCGCGGCTTGTTCAGCACCATCGTAACGAGCCTCACTGGCAGGGACACCAATGAGAATTGTGGCGAAGTGCAGGTCTTATCCACCGCTACGCAGTCCTTCCTGGGTACTGCGGTTAACGGCGTGATGTGGACCGTCTACCACGGGGCGGGTGCCAAGACCATCAGCGGCCCGAAGGGACCTGTCAATCAAATGTACACTAATGTTGACCAAGACTTGGTGGGGTGGCCAGCACCCCCCGGAGTCAGATCTCTTGCTCCGTGCACCTGCGGCTCGGCAGACTTGTATCTAGTCACCAGGCACGCGGATGTAATACCCGTGCGCAGGAGAGGAGACACCAGAGGAGCTCTCTTGAGCCCTAGACCAATATCCATTCTTAAGGGATCTTCCGGAGGTCCGCTGCTGTGCCCCATGGGACACCGCGCCGGCATATTCCGTGCGGCGGTGTGTACTCGGGGGGTAGCCAAGGCGGTAGACTTCGTCCCGGTTGAATCTCTTGAGACTACCATGAGATCACCAGTGTTCACTGACAACTCAACACCCCCAGCAGTGCCCCAGACCTACCAGGTCGCGCACCTACACGCACCAACAGGAAGTGGCAAGAGCACTAAGGTCCCGGCGGCGCATGCTGCCCAAGGCTATAAAGTGCTAGTGCTCAATCCTTCGGTTGCGGCCACACTGGGTTTTGGGGTATACATGTCCAAGGCATATGGCATCGACCCGAACATCCGGTCGGGAGTCAGGACCATCACCACGGGTGCGCCAATCACGTACTCAACGTATGGTAAGTTCCTGGCTGATGGAGGTTGCAGCGGAGGGGCATACGACATAATCATCTGTGACGAGTGCTATTCCACTGACTCCACAACGATCCTTGGCATAGGCACAGTCCTGGACCAAGCGGAGACCGCTGGAGTGCGCCTCACCGTGCTCGCGACTGCTACTCCGCCAGGGTCAGTGACTACACCTCATTCCAACATAGAGGAGGTCGCCCTGCCAACAACGGGGGAAATACCCTTTTACGGCAAGGCGATCCCTCTGGAGCTGATCAAGGGGGGCAGACATCTCATCTTCTGCCATTCAAAGAAAAAGTGCGATGAACTGGCCAGACAACTGACATCTCTTGGTCTGAATGCCGTAGCCTACTACAGAGGCTTAGACGTTTCGGTGATTCCCACGTCTGGGGACGTCGTGGTATGCGCCACGGACGCCCTCATGACGGGTTTCACCGGCGACTTTGACTCAGTGATAGACTGCAATACATCTGTGATACAGACTGTTGACTTCAGCTTGGACCCCACCTTCTCCATAGAGATTACAACCGTTCCCCAGGACGCGGTATCCCGCAGCCAGCGGAGAGGCCGCACTGGTAGGGGGAGGTTGGGCACATACCGGTATGTCACCCCGGGAGAGAGACCATCAGGCATGTTTGACACTGCAGAGCTTTGCGAGTGCTACGATGCCGGGTGCGCCTGGTACGAGCTGACACCTGCTGAAACCACAACAAGGCTGAAAGCTTACTTCGACACACCAGGCCTTCCTGTGTGCCAAGACCATCTGGAATTCTGGGAGAGCGTCTTTACAGGGTTAACCCACATAGACGGTCATTTCCTATCCCAGACCAAGCAATCGGGTGAGAATTTCCCGTATCTTGTTGCTTACCAAGCGACGGTGTCGGCCAAGGTCTGGCTCGCTCCACCAAGCTGGGACACCATGTGGAAGTGCCTAATTCGCCTTAAGCCCACCCTGCACGGGCCCACGCCCCTCCTCTACAGACTGGGGTCTGTGCAGAATGAAGTGGTGCTCACCCATCCCATCACCAAATACATCATGGCTTGCATGTCAGCTGATCTCGAGGTAGTGACAAGTACGTGGGTCTTGGTGGGCGGCGTCCTGGCAGCTCTGGCTGCTTACTGTCTTTCAGTGGGCAGCGTAGTGATTGTTGGGAGAGTCGTCCTGTCGGGCCAACCTGCTGTCATTCCTGATCGCGAAGTGCTCTACCAACAGTTCGACGAAATGGAGGAGTGTTCCAAACACCTCCCACTAGTCGAGCACGGGTTACAACTGGCTGAGCAGTTCAAGCAGAAGGCCTTAGGTCTCCTAAATTTCGCTGGCAAGCAAGCCCAAGAGGCAACACCAGTGATCCAGTCTAACTTCGCTAAACTTGAGCAGTTTTGGGCGAACGACATGTGGAATTTCATCAGCGGCATTCAATATCTCGCTGGACTGTCTACTTTGCCAGGCAATCCTGCCATTGCTTCCCTCATGTCCTTTACTGCTGCCGTTACAAGCCCTCTGACCACCCAACAAACCCTCCTTTTTAACATCTTGGGGGGATGGGTGGCCTCACAGATTCGCGACTCCGATGCTTCTACCGCATTCGTCGTGAGCGGCTTGGCGGGGGCGGCAGTTGGCAGTGTGGGCCTTGGCAAAATTTTGGTGGACATTCTGCCCGGTTACGGCGCCGGCGTACGTGGCGCTGTGGTTACCTTCAAGATCATGAGCGGCGAGATGCCTTCCACAGAGGACTTGGTAAATTTGCTCCCGGCCATTCTATCGCCCGGAGCATTGGTGGTGGAGGTGGTATGCCCGGCGATTTTGCGCCGCCACGTGGGCCCGGGCGAAGGGGCCGTGCAGTGGATGAACCGTCTAATTGCGTTCGCATCGCGAGGCAATCACGTGTCTCCCACGCATTACGTCCCTGAGTCCGACGCGGCACGCCGCGTGACCACCATACTATCATCCCTCACTGTGACATCCCTTCTCAGACGCCTCCACAAGTGGATCAATGAAGATTGCTCCACCCCATGTGCCGAATCTTGGCTATGGGAGGTATGGGATTGGGTCTTGCACGTGCTGAGTGACTTCAAGACGTGCTTAAAAGCAAAGTTCGTGCCCTTAATGCCAGGCATCCCCCTCCTCTCATGGCCAAGAGGCTATAAGGGAGAGTGGCGCGGAGATGGCGTGATGCATACGACATGCCCCTGCGGAGCAGATCTGGCAGGTCACATCAAGAACGGCTCGATGAGAATCACCGGGCCGAAAACCTGCAGCAACACATGGCATGGAACCTTCCCCATCAATGCCTACACCACAGGCCCTGGTGTACCCATCCCGGCTCCGAACTACAAGTTCGCGCTTTGGAGGGTGTCCGCCGAGGACTACGTGGAGGTTCGCAGAGTGGGTGATTTCCATTATGTCACCGGGGTAACACAAGACAACATCAAGTTCCCCTGCCAAGTTCCGGCCCCAGAGCTCTTCACGGAAGTGGACGGCATCAGGATACACCGCCACGCCCCTAAGTGCAAACCCTTGCTGCGGGACGAAGTGTCGTTCTCAGTAGGACTCAATTCGTTCGTAGTGGGATCACAACTCCCATGCGAGCCAGAGCCGGACGTGGCAGTGCTAACATCCATGCTGACAGACCCATCACACATAACGGCGGAATCGGCGCGTCGGAGATTGGCTCGAGGGTCACGACCCTCGCTAGCTAGTTCCTCGGCGAGTCAGCTTTCGCCCCGTCTTCTTCAGGCCACGTGTACCGCTCCCCATGACTCCCCTGGTACTGATCTCCTCGAGGCTAACCTCTTGTGGGGGTCTACCGCTACCAGGGTTGAGACGGACGAGAAGGTAATAATACTAGACTCTTTTGAGTCATGTGTGGCTGAGCAAAATGATGACAGGGAAGTCTCGGTTGCCGCGGAAATCCTGCGTCCGACCAAGAAGTTCCCTCCAGCACTACCGATCTGGGCCCGGCCGGACTACAATCCACCTCTTACCGAGACGTGGAAGCAGCAGGACTACCAAGCTCCGACCGTCCACGGTTGCGCTCTGCCTCCGGCAAAGCAGCCCCCTGTTCCCTCTCCCAGGAGGAAACGGACGGTACAGCTCACTGAGTCCGTTGTTTCTACCGCTTTGGCAGAGCTGGCCGCAAAGACCTTTGGCCAGTCAGAGCCGAGCTCAGACCGTGATACAGACCTTACCACCCCAACTGAGACCACAGACTCGGGCCCCATCGTCGTGGATGATGCATCCGATGACGGATCTTATTCGTCAATGCCTCCACTAGAGGGGGAGCCCGGTGACCCGGACTTGACATCAGACTCTTGGTCCACTGTTAGCGGATCGGAGGACGTCGTGTGCTGTTCGATGTCATACTCGTGGACTGGGGCGCTTGTAACACCTTGCGCGGCTGAAGAATCAAAGCTGCCAATTAGCCCCCTGAGCAATTCACTTTTGCGCCATCACAATATGGTGTATGCCACGACCACCCGTTCTGCTGTGACACGGCAGAAGAAGGTGACCTTCGACCGCCTGCAGGTGGTGGACAGTACCTACAATGAAGTGCTTAAGGAGATAAAGGCACGAGCATCCAGAGTGAAGCCACGCTTGCTTACCACAGAGGAAGCTTGCGACCTGACGCCCCCCCACTCAGCCAGATCAAAGTTCGGCTACGGGAAAAAGGATGTTCGGAGCCATTCCCGCAAGGCCATTAACCACATCAGCTCCGTGTGGAAGGACTTGCTGGACGACAACAATACCCCAATTCCAACAACAATCATGGCCAAAAATGAGGTCTTCGCTGTGAACCCAGCGAAGGGAGGTCGGAAGCCTGCTCGCCTGATCGTGTATCCGGATCTCGGATCCCGGGTTTGCGAGAAGAGAGCGCTTCACGACGTCATCAAAAAAACTGCCTTAGCCGTGATGGGAGCCGCTTATGGCTTCCAATACTCCCCAGCGCAGCGGGTGGAATTTCTTCTGACTGCTTGGAAGTCGAAGAACGACCCAATGGGGTTCTCTTATGATACCCGCTGCTTTGACTCCACTGTAACCGAAAAGGACATCAGGGTCGAGGAAGAGGTCTATCAGTGTTGTGACCTGGAGCCCGAAGCCCGCAAAGTCATCACCGCCCTCACAGATAGACTCTATGTGGGCGGCCCTATGCACAACAGCAAGGGAGACCTTTGTGGGTATCGGAGATGTCGCGCAACCGGCGTCTACACCACCAGCTTCGGGAACACGCTGACGTGCTATCTCAAAGCCACGGCCGCCATCAGGGCGGCGGCGCTGAGAGACTGCACTATGTTGGTTTGCGGTGATGACTTAGTCGTCATCGCTGAGAGCGACGGCGTAGAGGAGGACAACCGAGCCCTCCGAGCCTTCACGGAGGCTATGACGAGATACTCGGCTCCCCCAGGTGACGCTCCGCAGCCAGCATATGACCTGGAACTAATAACATCATGTTCATCCAACGTCTCAGTCGCGCACGACGTGACGGGTAAAAAGGTATATTACCTAACCCGAGACCCTGAAACTCCCTTGGCGCGAGCTGTATGGGAGACAGTCCGACACACTCCAGTCAATTCCTGGTTGGGAAACATCATAGTCTACGCTCCCACAATATGGGTGCGCATGATATTGATGACCCACTTTTTCTCAATACTCCAGAGCCAGGAAGCCCTTGAGAAAGCACTCGACTTCGATATGTACGGAGTCACCTACTCTATCACTCCGCTGGATTTACCGGCAATCATTCAAAGACTCCATGGCTTAAGCGCGTTCACGCTGCACGGATACTCTCCACACGAACTCAACCGGGTGGCCGGAGCCCTCAGAAAACTTGGGGTACCCCCGCTGAGAGCGTGGAGACATCGGGCCCGAGCAGTCCGCGCTAAGCTTATCGCCCAGGGAGGTAGAGCCAAAATATGTGGCATATACCTCTTTAACTGGGCGGTAAAAACCAAACTCAAACTCACTCCATTGCCTGCCGCTGCCAAACTCGATTTATCGGGTTGGTTTACGGTAGGCGCCGGCGGGGGAGACATTTATCACAGCATGTCTCATGCCCGACCCCGCTATTTACTCCTGTGCCTACTCATACTTACAGTAGGGGTAGGCATCTTCCTGCTGCCTGCTCGGTAGGCAGCTTAACACTCCGACCTTAGGGTCCCCTTTTTTTTTTTTTTTTTGG&quot;
</code></pre><p>We load in our query sequences.</p>
<pre><code class="lang-r">nucseq &lt;- readDNAStringSet(nucseq.fn)
</code></pre>
<p>Now we can perform pairwise alignment with the reference.</p>
<pre><code class="lang-r">sm &lt;- nucleotideSubstitutionMatrix(match=<span class="hljs-number">1</span>,mismatch=<span class="hljs-number">0</span>,baseOnly=<span class="hljs-literal">FALSE</span>,type=<span class="hljs-string">&quot;DNA&quot;</span>)
nucseq.pa &lt;- pairwiseAlignment(nucseq,subject,type=<span class="hljs-string">&quot;local&quot;</span>,substitutionMatrix=sm,gapOpening=<span class="hljs-number">1</span>,gapExtension=<span class="hljs-number">2</span>) %&gt;% aligned
names(nucseq.pa) &lt;- names(nucseq)
writeXStringSet(nucseq.pa,paste(nucseq.fn,<span class="hljs-string">&quot;.mapped&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>))
</code></pre>
<p>If we map to a genome, we also get a nice side effect; the coverage across the genome of our sequences.</p>
<p>This little function calculates the number of non-gaps in a vector of characters.</p>
<pre><code class="lang-r">nongaps &lt;- <span class="hljs-keyword">function</span>(x){
  sum(x!=<span class="hljs-string">&quot;-&quot;</span>)
}
</code></pre>
<p>We convert the pairwise alignments into a matrix, and then work out the number of nongap characters in each column.</p>
<pre><code class="lang-r">nucseq.pa.matrix &lt;- as.matrix(nucseq.pa)
</code></pre>
<pre><code>## Error in as.vector(data): no method for coercing this S4 class to a vector
</code></pre><pre><code class="lang-r">nucseq.pa.coverage &lt;- apply(nucseq.pa.matrix,<span class="hljs-number">2</span>,nongaps)
</code></pre>
<pre><code>## Error in apply(nucseq.pa.matrix, 2, nongaps): object &apos;nucseq.pa.matrix&apos; not found
</code></pre><pre><code class="lang-r">plot(nucseq.pa.coverage,type=<span class="hljs-string">&quot;s&quot;</span>,xlab=<span class="hljs-string">&quot;Position&quot;</span>,ylab=<span class="hljs-string">&quot;Coverage&quot;</span>)
</code></pre>
<pre><code>## Error in plot(nucseq.pa.coverage, type = &quot;s&quot;, xlab = &quot;Position&quot;, ylab = &quot;Coverage&quot;): error in evaluating the argument &apos;x&apos; in selecting a method for function &apos;plot&apos;: Error: object &apos;nucseq.pa.coverage&apos; not found
</code></pre><p>I&apos;ll keep only columns with some non-gaps.</p>
<pre><code class="lang-r">nucseq.pa.nongaps &lt;- nucseq.pa.matrix[,nucseq.pa.coverage&gt;<span class="hljs-number">0</span>]
</code></pre>
<pre><code>## Error in eval(expr, envir, enclos): object &apos;nucseq.pa.matrix&apos; not found
</code></pre><p>I write the matrix of nucleotides to a file.</p>
<pre><code class="lang-r">output &lt;- paste(<span class="hljs-string">&quot;&gt;&quot;</span>,row.names(nucseq.pa.nongaps),<span class="hljs-string">&quot;\n&quot;</span>,apply(nucseq.pa.nongaps,<span class="hljs-number">1</span>,paste,collapse=<span class="hljs-string">&quot;&quot;</span>),sep=<span class="hljs-string">&quot;&quot;</span>)
</code></pre>
<pre><code>## Error in row.names(nucseq.pa.nongaps): object &apos;nucseq.pa.nongaps&apos; not found
</code></pre><pre><code class="lang-r">write(output,file=paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>))
</code></pre>
<pre><code>## Error in cat(x, file = file, sep = c(rep.int(sep, ncolumns - 1), &quot;\n&quot;), : object &apos;output&apos; not found
</code></pre><h2 id="reverse-alignment">Reverse alignment</h2>
<p>Once we have an in-frame set of nucleotide sequences, we can repeat the same procedure as for the nucleotide sequences except:</p>
<ul>
<li>We translate our in-frame nucleotide sequences</li>
<li>We align the translated amino acid sequences</li>
<li>We map the nucleotide sequences back to the translated alignment</li>
</ul>
<pre><code class="lang-r">myseqs &lt;- read.fasta(paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>))
</code></pre>
<pre><code>## Error in read.fasta(paste(nucseq.fn, &quot;.mapped.degapped&quot;, sep = &quot;&quot;)): no line starting with a &gt; character found
</code></pre><pre><code class="lang-r">myaaseq &lt;- lapply(myseqs,translate)
</code></pre>
<pre><code>## Error in lapply(myseqs, translate): object &apos;myseqs&apos; not found
</code></pre><pre><code class="lang-r">write.fasta(myaaseq,file.out=paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped.aa&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>),names=names(myaaseq))
</code></pre>
<pre><code>## Error in write.fasta(myaaseq, file.out = paste(nucseq.fn, &quot;.mapped.degapped.aa&quot;, : object &apos;myaaseq&apos; not found
</code></pre><pre><code class="lang-r">aaseq &lt;- readAAStringSet(paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped.aa&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>))
aaseq
</code></pre>
<pre><code>##   A AAStringSet instance of length 0
</code></pre><pre><code class="lang-r">aaseq.align &lt;- msa(aaseq,method=<span class="hljs-string">&quot;Muscle&quot;</span>)
</code></pre>
<pre><code>## Error in is(inputSeq, &quot;character&quot;): object &apos;aaseq&apos; not found
</code></pre><pre><code class="lang-r">writeXStringSet(aaseq.align@unmasked,paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped.aa.align&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>))
</code></pre>
<pre><code>## Error in is(x, &quot;XStringSet&quot;): object &apos;aaseq.align&apos; not found
</code></pre><p>Map the nucleotide MSA to the amino acid MSA.</p>
<pre><code class="lang-r">reverse.align(paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>),paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped.aa.align&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>),out.file=paste(nucseq.fn,<span class="hljs-string">&quot;.mapped.degapped.aa.revalign&quot;</span>,sep=<span class="hljs-string">&quot;&quot;</span>))
</code></pre>
<pre><code>## Error in read.fasta(nucl.file, forceDNAtolower = forceDNAtolower): no line starting with a &gt; character found
</code></pre><h2 id="using-codon-based-alignment">Using codon-based alignment</h2>
<p>If all else fails, then codon-based alignment can help to fix multiple frameshifts, even without a reference sequence.</p>
<pre><code class="lang-r">cmd &lt;- sprintf(<span class="hljs-string">&quot;java -jar macse_v1.01b.jar -prog alignSequences -seq %s&quot;</span>,nucseq.fn)
stdout &lt;- system(cmd)
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../align/example1.html" class="navigation navigation-prev " aria-label="Previous page: Nucleotide alignment"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../align/exercise1.html" class="navigation navigation-next " aria-label="Next page: Exercise"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-quizzes/quizzes.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-codeblock-disable-glossary/disable-glossary.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"autocover":{"title":"Molecular Epidemiology of Viruses in R","author":"Simon D.W. Frost","font":{"size":null,"family":"Impact","color":"#FFF"},"size":{"w":1800,"h":2360},"background":{"color":"#09F"}}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
    </body>
    <!-- End of book  -->
</html>
